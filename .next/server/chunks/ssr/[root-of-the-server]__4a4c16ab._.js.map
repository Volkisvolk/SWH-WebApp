{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Volka/Documents/Sketching/WebApp/beeapp/src/lib/auth.ts"],"sourcesContent":["import jwt from 'jsonwebtoken'\r\n\r\nexport interface Session {\r\n  id: number\r\n  role: 'admin' | 'user'\r\n}\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'dev-secret'\r\n\r\nexport function signSession(session: Session) {\r\n  return jwt.sign(session, JWT_SECRET, { expiresIn: '7d' })\r\n}\r\n\r\nexport function verifySession(token: string): Session | null {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET) as Session\r\n  } catch {\r\n    return null\r\n  }\r\n}\r\n\r\nexport const COOKIE_NAME = 'beeapp_token'\r\n"],"names":[],"mappings":";;;;;AAAA;;AAOA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,YAAY,OAAgB;IAC1C,OAAO,qIAAA,CAAA,UAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AACzD;AAEO,SAAS,cAAc,KAAa;IACzC,IAAI;QACF,OAAO,qIAAA,CAAA,UAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,MAAM,cAAc","debugId":null}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Volka/Documents/Sketching/WebApp/beeapp/src/app/admin/layout.tsx"],"sourcesContent":["import { cookies } from 'next/headers'\r\nimport { verifySession, COOKIE_NAME } from '@/lib/auth'\r\nimport { redirect } from 'next/navigation'\r\n\r\nexport default async function AdminLayout({ children }: { children: React.ReactNode }) {\r\n  const cookieStore = await cookies()\r\n  const token = cookieStore.get(COOKIE_NAME)?.value\r\n  const session = token ? verifySession(token) : null\r\n  if (!session || session.role !== 'admin') redirect('/')\r\n  return <>{children}</>\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAAA;;;;;AAEe,eAAe,YAAY,EAAE,QAAQ,EAAiC;IACnF,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IAChC,MAAM,QAAQ,YAAY,GAAG,CAAC,kHAAA,CAAA,cAAW,GAAG;IAC5C,MAAM,UAAU,QAAQ,CAAA,GAAA,kHAAA,CAAA,gBAAa,AAAD,EAAE,SAAS;IAC/C,IAAI,CAAC,WAAW,QAAQ,IAAI,KAAK,SAAS,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD,EAAE;IACnD,qBAAO;kBAAG;;AACZ","debugId":null}}]
}